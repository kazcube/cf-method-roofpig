<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>CF Method Cube Viewer v3.1 (GitHub版・安定)</title>
  <!-- jQuery & Roofpig（v3 で動いていた組み合わせ） -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/larspetrus/Roofpig/roofpig_and_three.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>CF Method Cube Viewer v3.1 (GitHub版・安定)</h1>
  <p style="text-align:center;font-size:13px;">
    3x3 と「コーナーのみ表示 (2x2 相当)」の Roofpig ビューア。<br>
    配色: U=白, D=黄, F=緑, B=青, R=赤, L=オレンジ
  </p>

  <div class="layout">
    <!-- 3x3 Viewer Panel -->
    <div class="panel">
      <h2>3x3 Viewer</h2>
      <div id="cube3" class="roofpig"
           data-config="alg=|colors=F:g B:b U:w D:y R:r L:o|hover=3|speed=700">
      </div>

      <!-- Random / 6E Scramble Controls -->
      <div class="btn-row">
        <button onclick="randomScramble()">Random Scramble (20)</button>
        <button onclick="randomScrambleApply()">Random + Apply</button>
        <button onclick="randomScrambleApplyCorner()">Random + Apply Corner</button>
      </div>
      <div class="btn-row">
        <button onclick="last6EScramble()">Last-6E Scramble (edge-biased)</button>
      </div>

      <div class="flex-row" style="margin-top:4px;">
        <span class="label-inline">スクランブル:</span>
        <button onclick="applyScramble()">Apply Scramble</button>
        <button onclick="resetCube()">Reset</button>
      </div>
      <textarea id="scrambleInput" placeholder="例: R U R' U' F2 D' L2 ..."></textarea>
      <div class="small-note">
        ※ Random Scramble は WCA 形式 20手を生成します（同じ面の連続なし）。<br>
        ※ Last-6E Scramble は今のところ「エッジ寄りの動きが多い顔 (U,D,F,B)」のスクランブルです（今後 CF-6E に合わせて精密化予定）。
      </div>

      <div class="face-group-title">面回転プリセット（Apply型：手順欄に追記）</div>
      <div class="btn-row">
        <button onclick='appendMove("U")'>U</button>
        <button onclick='appendMove("U&#39;")'>U'</button>
        <button onclick='appendMove("U2")'>U2</button>
        <button onclick='appendMove("R")'>R</button>
        <button onclick='appendMove("R&#39;")'>R'</button>
        <button onclick='appendMove("R2")'>R2</button>
        <button onclick='appendMove("L")'>L</button>
        <button onclick='appendMove("L&#39;")'>L'</button>
        <button onclick='appendMove("L2")'>L2</button>
      </div>
      <div class="btn-row">
        <button onclick='appendMove("F")'>F</button>
        <button onclick='appendMove("F&#39;")'>F'</button>
        <button onclick='appendMove("F2")'>F2</button>
        <button onclick='appendMove("B")'>B</button>
        <button onclick='appendMove("B&#39;")'>B'</button>
        <button onclick='appendMove("B2")'>B2</button>
        <button onclick='appendMove("D")'>D</button>
        <button onclick='appendMove("D&#39;")'>D'</button>
        <button onclick='appendMove("D2")'>D2</button>
      </div>

      <div class="face-group-title">Apply型手順（まとめて適用）</div>
      <textarea id="algInput" placeholder="ここに検証したい手順を入力（例: R U R' U'）"></textarea>
      <div class="btn-row">
        <button onclick="applyAlg()">この手順を適用（alg=）</button>
        <button onclick="clearAlg()">手順クリア</button>
      </div>

      <div class="face-group-title">即時反映型（Immediate）</div>
      <div class="btn-row">
        <button onclick='immediateMove("U")'>U</button>
        <button onclick='immediateMove("U&#39;")'>U'</button>
        <button onclick='immediateMove("U2")'>U2</button>
        <button onclick='immediateMove("R")'>R</button>
        <button onclick='immediateMove("R&#39;")'>R'</button>
        <button onclick='immediateMove("R2")'>R2</button>
        <button onclick='immediateMove("L")'>L</button>
        <button onclick='immediateMove("L&#39;")'>L'</button>
        <button onclick='immediateMove("L2")'>L2</button>
      </div>
      <div class="btn-row">
        <button onclick='immediateMove("F")'>F</button>
        <button onclick='immediateMove("F&#39;")'>F'</button>
        <button onclick='immediateMove("F2")'>F2</button>
        <button onclick='immediateMove("B")'>B</button>
        <button onclick='immediateMove("B&#39;")'>B'</button>
        <button onclick='immediateMove("B2")'>B2</button>
        <button onclick='immediateMove("D")'>D</button>
        <button onclick='immediateMove("D&#39;")'>D'</button>
        <button onclick='immediateMove("D2")'>D2</button>
      </div>
      <div class="small-note">
        ※ 「Apply型」は手順をまとめて書いてから適用するモードです。<br>
        ※ 「即時反映型」はボタンを押した瞬間に alg に 1手ずつ追記し、その場で反映します。
      </div>

      <div class="small-note">
        Roofpig 標準 UI（再生ボタン・スライダー）で 1 手ずつの確認も可能です。
      </div>
    </div>

    <!-- Corner-only Viewer Panel -->
    <div class="panel">
      <h2>Corner-only Viewer (2x2 相当)</h2>
      <div id="cube2" class="roofpig"
           data-config="alg=|colors=F:g B:b U:w D:y R:r L:o|pieces=corner|hover=3|speed=700">
      </div>
      <p class="small-note">
        エッジを無視してコーナーのみを表示しています（pieces=corner）。<br>
        2x2 の OCLL/OCPLL や 8 コーナー CF 法の研究に使えます。
      </p>

      <div class="face-group-title">同じ Scramble を適用</div>
      <div class="btn-row">
        <button onclick="applyScrambleToCorner()">Scrambleを適用（コーナーのみ）</button>
        <button onclick="resetCorner()">Reset (コーナー)</button>
      </div>

      <div class="face-group-title">このビューのための手順</div>
      <textarea id="algInputCorner" placeholder="2x2/8コーナー用の手順（R U R' U' など）"></textarea>
      <div class="btn-row">
        <button onclick="applyAlgCorner()">この手順を適用（corner alg）</button>
        <button onclick="clearAlgCorner()">手順クリア</button>
      </div>

      <div class="small-note">
        ※ ここも Roofpig 標準 UI で 1 手ずつ確認可能です。<br>
        ※ 実質「2x2 CF 法ビューア」として使えます（エッジは見えますが、動きはコーナー主体になります）。
      </div>
    </div>
  </div>

  <script src="viewer.js"></script>
</body>
</html>
